<!DOCTYPE html>
<html>
<head>
<title>ESCAPE ROAD - ULTRA PREMIUM</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Orbitron',monospace;overflow:hidden;background:#000}
#gameBox{position:relative;width:100vw;height:100vh;background:radial-gradient(circle at center,#0a0a15,#000)}
canvas{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);border:5px solid;border-image:linear-gradient(45deg,#f44,#fa0,#0ff,#44f,#f44) 1;box-shadow:0 0 80px rgba(255,68,68,0.6),inset 0 0 60px rgba(0,0,0,0.4);animation:borderPulse 3s infinite}
@keyframes borderPulse{0%,100%{filter:brightness(1)}50%{filter:brightness(1.3)}}
#hud{position:absolute;top:25px;left:25px;right:25px;display:flex;justify-content:space-between;pointer-events:none;z-index:10}
.hudBox{background:linear-gradient(135deg,rgba(0,0,0,0.95),rgba(20,20,50,0.9));padding:18px 30px;border-radius:20px;border:3px solid;margin:0 10px;backdrop-filter:blur(15px);box-shadow:0 10px 40px rgba(0,0,0,0.7),inset 0 2px 10px rgba(255,255,255,0.1);transition:all .3s;animation:hudFloat 3s ease-in-out infinite}
@keyframes hudFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
.t{border-color:#0f0;background:linear-gradient(135deg,rgba(0,255,0,0.15),rgba(0,150,0,0.1))}
.s{border-color:#0ff;background:linear-gradient(135deg,rgba(0,255,255,0.15),rgba(0,150,150,0.1))}
.c{border-color:#fa0;background:linear-gradient(135deg,rgba(255,170,0,0.15),rgba(150,100,0,0.1))}
.w{border-color:#f44;background:linear-gradient(135deg,rgba(255,68,68,0.15),rgba(150,0,0,0.1))}
.hudLabel{font-size:11px;letter-spacing:3px;opacity:0.8;margin-bottom:6px;text-transform:uppercase;font-weight:700}
.hudValue{font-size:24px;font-weight:900;text-shadow:0 0 15px currentColor,0 0 30px currentColor}
.t .hudValue{color:#0f0}
.s .hudValue{color:#0ff}
.c .hudValue{color:#fa0}
.w .hudValue{color:#f44}
#stars{position:absolute;top:120px;right:30px;font-size:36px;color:#ff4;text-shadow:0 0 25px #f00,0 0 50px #f00;animation:starPulse 1s infinite}
@keyframes starPulse{0%,100%{transform:scale(1) rotate(0deg)}50%{transform:scale(1.2) rotate(5deg)}}
#jukeMsg{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:64px;font-weight:900;color:#0ff;text-shadow:0 0 40px #0ff,0 0 80px #0ff;opacity:0;pointer-events:none;transition:opacity .3s;z-index:100;animation:msgBounce 0.5s ease-out}
@keyframes msgBounce{0%{transform:translate(-50%,-50%) scale(0.5)}50%{transform:translate(-50%,-50%) scale(1.2)}100%{transform:translate(-50%,-50%) scale(1)}}
#jukeMsg.show{opacity:1}
.screen{position:absolute;inset:0;background:radial-gradient(circle,rgba(10,10,35,0.98),rgba(0,0,5,0.99));display:flex;flex-direction:column;justify-content:center;align-items:center;color:#fff;z-index:999;backdrop-filter:blur(25px);overflow-y:auto}
.title{font-size:clamp(60px,14vw,110px);font-weight:900;margin-bottom:30px;background:linear-gradient(135deg,#f44,#fa0,#ff0,#0ff,#44f,#f4f);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-size:200% 200%;letter-spacing:8px;text-transform:uppercase;animation:titleShine 4s infinite,titleFloat 3s ease-in-out infinite;filter:drop-shadow(0 0 30px rgba(255,68,68,0.5))}
@keyframes titleShine{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes titleFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.subtitle{font-size:clamp(18px,5vw,28px);margin-bottom:50px;color:#0ff;letter-spacing:6px;text-transform:uppercase;text-shadow:0 0 25px #0ff,0 0 50px #0ff;animation:subtitlePulse 2s infinite}
@keyframes subtitlePulse{0%,100%{opacity:1}50%{opacity:0.7}}
.btn{position:relative;padding:clamp(18px,5vw,26px) clamp(40px,8vw,60px);font:bold clamp(18px,5vw,24px) 'Orbitron';background:linear-gradient(135deg,#f44,#c22);color:#fff;border:4px solid #f66;border-radius:35px;cursor:pointer;margin:16px;letter-spacing:4px;text-transform:uppercase;box-shadow:0 10px 40px rgba(255,68,68,0.5),inset 0 3px 15px rgba(255,255,255,0.3);transition:all .3s;overflow:hidden}
.btn::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,0.3),transparent);opacity:0;transition:opacity .3s}
.btn:hover{transform:translateY(-5px) scale(1.05);box-shadow:0 15px 50px rgba(255,68,68,0.7),inset 0 3px 15px rgba(255,255,255,0.4);border-color:#ff8}
.btn:hover::before{opacity:1;animation:btnShine 1s infinite}
@keyframes btnShine{0%{transform:translate(-100%,-100%)}100%{transform:translate(100%,100%)}}
.btn:active{transform:translateY(0) scale(0.98)}
.adminBtn{background:linear-gradient(135deg,#f0f,#a0a);border-color:#f0f;font-size:16px;padding:14px 25px;margin:10px;box-shadow:0 10px 40px rgba(255,0,255,0.5)}
.shopGrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:25px;max-width:95vw;margin:30px 0;padding:25px;max-height:62vh;overflow-y:auto}
.shopGrid::-webkit-scrollbar{width:12px}
.shopGrid::-webkit-scrollbar-track{background:rgba(0,0,0,0.3);border-radius:10px}
.shopGrid::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#f44,#0ff);border-radius:10px;box-shadow:0 0 10px rgba(255,68,68,0.5)}
.carCard{background:linear-gradient(135deg,rgba(30,30,80,0.98),rgba(50,50,100,0.95));padding:28px 30px;border:4px solid #666;border-radius:25px;cursor:pointer;transition:all .4s;text-align:center;box-shadow:0 15px 50px rgba(0,0,0,0.6),inset 0 2px 15px rgba(255,255,255,0.1);position:relative;overflow:hidden;min-height:240px;display:flex;flex-direction:column;justify-content:space-between}
.carCard::before{content:'';position:absolute;inset:-100%;background:conic-gradient(from 0deg,transparent,rgba(255,255,255,0.2),transparent);opacity:0;transition:all .6s;animation:cardRotate 3s linear infinite paused}
@keyframes cardRotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.carCard:hover:not(.locked)::before{opacity:1;animation-play-state:running}
.carCard:hover:not(.locked){border-color:#0ff;transform:translateY(-8px) scale(1.05);box-shadow:0 20px 70px rgba(0,255,255,0.4),inset 0 3px 20px rgba(255,255,255,0.2)}
.carCard.selected{border-color:#0f0;box-shadow:0 0 50px #0f0,0 0 100px rgba(0,255,0,0.3);animation:selectedGlow 2s infinite}
@keyframes selectedGlow{0%,100%{box-shadow:0 0 50px #0f0,0 0 100px rgba(0,255,0,0.3)}50%{box-shadow:0 0 70px #0f0,0 0 140px rgba(0,255,0,0.5)}}
.carCard.locked{opacity:0.35;cursor:not-allowed;filter:grayscale(1) brightness(0.6)}
.carContent{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center}
.emoji{font-size:clamp(55px,13vw,75px);margin-bottom:12px;filter:drop-shadow(0 8px 20px rgba(0,0,0,0.7));animation:emojiFloat 2s ease-in-out infinite}
@keyframes emojiFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.carName{font-size:clamp(17px,4.5vw,24px);font-weight:900;margin-bottom:8px;text-transform:uppercase;letter-spacing:3px;text-shadow:0 2px 10px rgba(0,0,0,0.5);color:#fff}
.carInfo{font-size:clamp(12px,3vw,14px);color:#aaa;margin-bottom:8px;letter-spacing:1px;text-shadow:0 2px 5px rgba(0,0,0,0.5);line-height:1.4}
.abilityText{font-size:clamp(11px,2.8vw,13px);color:#0ff;margin-top:6px;font-weight:700;text-shadow:0 0 10px #0ff}
.speedFast{color:#0f0;text-shadow:0 0 10px #0f0}
.speedMedium{color:#fa0;text-shadow:0 0 10px #fa0}
.speedSlow{color:#f44;text-shadow:0 0 10px #f44}
.carPrice{font-size:clamp(20px,5.5vw,28px);font-weight:900;color:#fa0;text-shadow:0 0 20px #fa0,0 0 40px #fa0;margin-top:8px}
.stats{display:flex;gap:35px;margin:35px 0;flex-wrap:wrap;justify-content:center}
.statBox{background:linear-gradient(135deg,rgba(30,30,80,0.98),rgba(50,50,100,0.95));padding:30px 40px;border-radius:25px;border:4px solid;min-width:180px;box-shadow:0 15px 50px rgba(0,0,0,0.6);transition:transform .3s}
.statBox:hover{transform:translateY(-8px) scale(1.05)}
.statLabel{font-size:13px;color:#aaa;letter-spacing:4px;margin-bottom:12px;text-transform:uppercase;font-weight:700}
.statValue{font-size:clamp(32px,8vw,42px);font-weight:900;text-shadow:0 0 25px currentColor,0 0 50px currentColor}
#controls{position:absolute;bottom:25px;right:25px;background:rgba(0,0,0,0.9);padding:20px 30px;border-radius:20px;border:3px solid #0ff;font-size:15px;color:#0ff;backdrop-filter:blur(15px);box-shadow:0 8px 40px rgba(0,255,255,0.4)}
#controls div{margin:8px 0;letter-spacing:2px;font-weight:700}
#abilityHint{color:#f0f;font-size:16px;margin-top:10px;text-shadow:0 0 15px #f0f}
input{font-family:'Orbitron',monospace;padding:18px 30px;font-size:20px;border:4px solid #0ff;border-radius:20px;background:rgba(0,0,0,0.9);color:#0ff;margin:25px;text-align:center;letter-spacing:3px;box-shadow:0 5px 30px rgba(0,255,255,0.3)}
input::placeholder{color:#066}
.adminPanel{background:linear-gradient(135deg,rgba(60,0,80,0.98),rgba(80,0,100,0.95));padding:35px;border-radius:25px;border:4px solid #f0f;margin:25px;max-width:650px;box-shadow:0 15px 50px rgba(255,0,255,0.4)}
.adminPanel h3{color:#f0f;margin-bottom:18px;text-shadow:0 0 25px #f0f;font-size:24px;letter-spacing:3px}
.adminPanel button{margin:12px}
</style>
</head>
<body>
<div id="gameBox">
<canvas id="c"></canvas>
<div id="hud" style="display:none">
<div class="hudBox t">
<div class="hudLabel">Time</div>
<div class="hudValue" id="timeVal">0:00</div>
</div>
<div class="hudBox s">
<div class="hudLabel">Speed</div>
<div class="hudValue" id="speedVal">0</div>
</div>
<div class="hudBox c">
<div class="hudLabel">Cash</div>
<div class="hudValue" id="cashVal">$0</div>
</div>
<div class="hudBox w">
<div class="hudLabel">Wanted</div>
<div class="hudValue" id="wantedVal">‚òÖ</div>
</div>
</div>
<div id="stars" style="display:none">‚òÖ</div>
<div id="jukeMsg">JUKED! üéØ</div>
<div id="controls" style="display:none">
<div>‚Üë ACCELERATE</div>
<div>‚Üì BRAKE</div>
<div>‚Üê ‚Üí STEER</div>
<div><strong>L</strong> JUKE COPS</div>
<div><strong>SPACE</strong> SHOOT</div>
<div id="abilityHint"></div>
</div>

<div id="menuScreen" class="screen">
<div class="title">ESCAPE ROAD</div>
<div class="subtitle">Ultra Premium Edition</div>
<button class="btn" onclick="startGame()">‚ñ∂ Play Game</button>
<button class="btn" onclick="openShop()">üè™ Garage</button>
<button class="adminBtn" onclick="openAdmin()">üîê Admin Panel</button>
</div>

<div id="adminLoginScreen" class="screen" style="display:none">
<div class="title" style="font-size:clamp(45px,11vw,80px)">üîê Admin Login</div>
<input type="password" id="adminPass" placeholder="Enter Password" onkeypress="if(event.key==='Enter')checkAdmin()">
<button class="btn" onclick="checkAdmin()">Login</button>
<button class="btn" onclick="backToMenu()">‚óÄ Back</button>
<div id="adminError" style="color:#f44;margin-top:25px;display:none;font-size:20px;text-shadow:0 0 20px #f44">‚ùå Wrong Password!</div>
</div>

<div id="adminScreen" class="screen" style="display:none">
<div class="title" style="font-size:clamp(45px,11vw,80px)">üëë Admin Panel</div>
<div style="font-size:28px;color:#f0f;margin-bottom:25px;text-shadow:0 0 25px #f0f;font-weight:900">
üí∞ $<span id="adminMoney">0</span>
</div>
<div class="adminPanel">
<h3>üí∞ Money Controls</h3>
<button class="btn" onclick="addMoney(5000)">+$5,000</button>
<button class="btn" onclick="addMoney(25000)">+$25,000</button>
<button class="btn" onclick="addMoney(100000)">+$100,000</button>
<button class="btn" onclick="money=999999;updateAdminMoney()">MAX MONEY</button>
</div>
<div class="adminPanel">
<h3>üöó Car Controls</h3>
<button class="btn" onclick="unlockAllCars()">üîì Unlock All Cars</button>
<button class="btn" onclick="unlockAdminCar()">üëë Unlock ADMIN CAR</button>
</div>
<button class="btn" onclick="backToMenu()">‚óÄ Back to Menu</button>
</div>

<div id="shopScreen" class="screen" style="display:none">
<div class="title" style="font-size:clamp(40px,10vw,75px);margin-bottom:20px">üè™ Garage</div>
<div style="font-size:clamp(28px,6vw,36px);color:#fa0;margin-bottom:25px;font-weight:900;text-shadow:0 0 25px #fa0,0 0 50px #fa0">
üí∞ $<span id="shopMoney">0</span>
</div>
<div class="shopGrid" id="carGrid"></div>
<button class="btn" onclick="backToMenu()">‚óÄ Back to Menu</button>
</div>

<div id="overScreen" class="screen" style="display:none">
<div class="title" style="font-size:clamp(45px,11vw,85px)">üö® Busted!</div>
<div class="subtitle">Police Caught You</div>
<div class="stats">
<div class="statBox" style="border-color:#0f0">
<div class="statLabel">Survival Time</div>
<div class="statValue" style="color:#0f0" id="finalTime">0:00</div>
</div>
<div class="statBox" style="border-color:#fa0">
<div class="statLabel">Cash Earned</div>
<div class="statValue" style="color:#fa0" id="finalCash">$0</div>
</div>
</div>
<button class="btn" onclick="startGame()">‚ñ∂ Play Again</button>
<button class="btn" onclick="openShop()">üè™ Garage</button>
<button class="btn" onclick="backToMenu()">üè† Main Menu</button>
</div>
</div>

<script>
c=document.getElementById('c');
ctx=c.getContext('2d');
c.width=1200;c.height=750;

let screen='menu';
let money=10000,runCash=0,time=0,wanted=1,frame=0;
let px=700,py=500,pa=-Math.PI/2,ps=0,pmax=10;
let cx=0,cy=0;
let cops=[],coins=[],particles=[],bullets=[];
let currentCar='sedan';
let jukeReady=true,jukeCooldown=0;
let shootReady=true,shootCooldown=0;
let abilityReady=true,abilityCooldown=0;

let cars={
sedan:{n:'Sedan',e:'üöó',m:10,p:0,o:true,c:'#48f',gun:false,ability:'shield',abilityName:'Shield (5s)'},
van:{n:'Van',e:'üöê',m:8,p:2500,o:false,c:'#69f',gun:false,ability:'magnet',abilityName:'Coin Magnet'},
truck:{n:'Monster',e:'üõª',m:9,p:3500,o:false,c:'#a64',gun:false,ability:'ram',abilityName:'Ram Boost'},
suv:{n:'SUV',e:'üöô',m:11,p:4000,o:false,c:'#4a4',gun:false,ability:'shield',abilityName:'Shield (7s)'},
compact:{n:'Compact',e:'üöï',m:13,p:5000,o:false,c:'#fc4',gun:false,ability:'dash',abilityName:'Speed Dash'},
muscle:{n:'Muscle',e:'üöò',m:14,p:6500,o:false,c:'#fa0',gun:true,ability:'burst',abilityName:'Bullet Burst'},
limo:{n:'Limo',e:'üöê',m:10,p:7500,o:false,c:'#000',gun:false,ability:'coins',abilityName:'Rain Coins'},
coupe:{n:'Coupe',e:'üöô',m:15,p:9000,o:false,c:'#f6a',gun:true,ability:'snipe',abilityName:'Sniper Shot'},
sports:{n:'Sports',e:'üèéÔ∏è',m:17,p:12000,o:false,c:'#f44',gun:true,ability:'rapid',abilityName:'Rapid Fire'},
buggy:{n:'Buggy',e:'üèúÔ∏è',m:16,p:15000,o:false,c:'#fa4',gun:false,ability:'jump',abilityName:'Mega Jump'},
rally:{n:'Rally',e:'üèÅ',m:18,p:18000,o:false,c:'#0cf',gun:true,ability:'spread',abilityName:'Spread Shot'},
drift:{n:'Drift',e:'üöó',m:19,p:22000,o:false,c:'#f08',gun:false,ability:'drift',abilityName:'Drift Boost'},
super:{n:'Supercar',e:'üèÅ',m:21,p:28000,o:false,c:'#f4f',gun:true,ability:'laser',abilityName:'Laser Beam'},
racer:{n:'Racer',e:'üèéÔ∏è',m:22,p:35000,o:false,c:'#0f0',gun:true,ability:'missile',abilityName:'Homing Missile'},
hyper:{n:'Hyper',e:'üèÅ',m:24,p:45000,o:false,c:'#ff0',gun:true,ability:'wave',abilityName:'Shock Wave'},
formula:{n:'Formula',e:'üèéÔ∏è',m:26,p:60000,o:false,c:'#f00',gun:true,ability:'orbital',abilityName:'Orbital Strike'},
rocket:{n:'Rocket',e:'üöÄ',m:28,p:80000,o:false,c:'#0ff',gun:true,ability:'barrage',abilityName:'Missile Barrage'},
jet:{n:'Jet Car',e:'‚úàÔ∏è',m:30,p:110000,o:false,c:'#88f',gun:true,ability:'airstrike',abilityName:'Air Strike'},
cyber:{n:'Cyber',e:'ü§ñ',m:25,p:95000,o:false,c:'#0df',gun:true,ability:'emp',abilityName:'EMP Blast'},
tank:{n:'Tank',e:'üõ°Ô∏è',m:7,p:75000,o:false,c:'#484',gun:true,ability:'nuke',abilityName:'Mini Nuke'},
warcar:{n:'WAR CAR',e:'üí•',m:32,p:150000,o:false,c:'#f44',gun:true,ability:'destroy',abilityName:'Mass Destruction'},
admincar:{n:'ADMIN CAR',e:'üëë',m:35,p:0,o:false,c:'#f0f',gun:true,admin:true,ability:'explode',abilityName:'Cop Exploder'}
};

let map=[
[0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,1,1,1,1,1,1,1,1,1,1,1,0],
[0,1,0,0,1,1,0,0,0,1,1,1,0],
[0,1,0,0,1,1,0,0,0,1,1,1,0],
[0,1,1,1,1,1,1,1,1,1,1,1,0],
[0,1,0,0,0,0,0,0,0,0,1,1,0],
[0,1,1,1,1,1,1,1,1,1,1,1,0],
[0,1,0,0,1,1,0,0,0,1,1,1,0],
[0,1,0,0,1,1,0,0,0,1,1,1,0],
[0,1,1,1,1,1,1,1,1,1,1,1,0],
[0,1,0,0,0,0,0,0,0,0,1,1,0],
[0,1,1,1,1,1,1,1,1,1,1,1,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0]
];
TS=105;
let shieldActive=false,shieldTime=0;

function isRoad(x,y){
let tx=Math.floor(x/TS),ty=Math.floor(y/TS);
return map[ty]&&map[ty][tx]==1;
}

function openAdmin(){
screen='adminLogin';
document.getElementById('menuScreen').style.display='none';
document.getElementById('adminLoginScreen').style.display='flex';
document.getElementById('adminPass').value='';
document.getElementById('adminError').style.display='none';
}

function checkAdmin(){
let pass=document.getElementById('adminPass').value;
if(pass==='zayn2015'){
screen='admin';
document.getElementById('adminLoginScreen').style.display='none';
document.getElementById('adminScreen').style.display='flex';
updateAdminMoney();
}else{
document.getElementById('adminError').style.display='block';
setTimeout(()=>document.getElementById('adminError').style.display='none',2000);
}
}

function updateAdminMoney(){
document.getElementById('adminMoney').textContent=money;
}

function addMoney(amount){
money+=amount;
updateAdminMoney();
}

function unlockAllCars(){
Object.keys(cars).forEach(k=>{
if(k!=='admincar')cars[k].o=true;
});
alert('üîì All cars unlocked!');
}

function unlockAdminCar(){
cars.admincar.o=true;
alert('üëë ADMIN CAR UNLOCKED!');
}

function backToMenu(){
screen='menu';
document.getElementById('menuScreen').style.display='flex';
document.getElementById('shopScreen').style.display='none';
document.getElementById('overScreen').style.display='none';
document.getElementById('adminLoginScreen').style.display='none';
document.getElementById('adminScreen').style.display='none';
document.getElementById('hud').style.display='none';
document.getElementById('stars').style.display='none';
document.getElementById('controls').style.display='none';
}

function openShop(){
screen='shop';
document.getElementById('menuScreen').style.display='none';
document.getElementById('shopScreen').style.display='flex';
document.getElementById('overScreen').style.display='none';
document.getElementById('adminScreen').style.display='none';
document.getElementById('shopMoney').textContent=money;
renderShop();
}

function getSpeedClass(speed){
if(speed>=20)return 'speedFast';
if(speed>=12)return 'speedMedium';
return 'speedSlow';
}

function renderShop(){
let grid=document.getElementById('carGrid');
grid.innerHTML='';
Object.keys(cars).forEach(k=>{
let car=cars[k];
let card=document.createElement('div');
card.className=`carCard ${car.o?'':'locked'} ${currentCar==k?'selected':''}`;
card.innerHTML=`
<div class="carContent">
<div class="emoji">${car.e}</div>
<div class="carName">${car.n}</div>
<div class="carInfo">Speed: <span class="${getSpeedClass(car.m)}">${car.m}</span>${car.gun?' üî´':''}</div>
<div class="abilityText">A: ${car.abilityName}</div>
</div>
<div class="carPrice">${car.o?(currentCar==k?'‚úÖ SELECTED':'TAP TO SELECT'):(car.p===0?'ADMIN ONLY':'$'+car.p.toLocaleString())}</div>
`;
card.onclick=function(){
if(car.o){
currentCar=k;
pmax=car.m;
renderShop();
}else if(money>=car.p&&car.p>0){
money-=car.p;
car.o=true;
currentCar=k;
pmax=car.m;
document.getElementById('shopMoney').textContent=money;
renderShop();
}
};
grid.appendChild(card);
});
}

function useAbility(){
if(!abilityReady)return;
let car=cars[currentCar];
abilityReady=false;
abilityCooldown=180;
switch(car.ability){
case'explode':
cops.forEach(cop=>{
for(let i=0;i<60;i++){
particles.push({
x:cop.x,y:cop.y,
vx:(Math.random()-0.5)*20,
vy:(Math.random()-0.5)*20,
life:1.2,decay:0.018,
color:['#f44','#fa0','#ff0','#f0f'][Math.floor(Math.random()*4)],
size:6+Math.random()*10
});
}
});
runCash+=cops.length*500;
cops=[];
break;
case'shield':
shieldActive=true;
shieldTime=car.n==='SUV'?420:300;
break;
case'magnet':
coins.forEach(coin=>{
let angle=Math.atan2(py-coin.y,px-coin.x);
coin.x+=Math.cos(angle)*30;
coin.y+=Math.sin(angle)*30;
});
break;
case'ram':
ps=pmax*2;
cops.forEach(cop=>{
if(Math.hypot(cop.x-px,cop.y-py)<150){
let angle=Math.atan2(cop.y-py,cop.x-px);
cop.x+=Math.cos(angle)*300;
cop.y+=Math.sin(angle)*300;
}
});
break;
case'dash':
let dashDist=400;
px+=Math.cos(pa)*dashDist;
py+=Math.sin(pa)*dashDist;
for(let i=0;i<30;i++){
particles.push({
x:px-Math.cos(pa)*i*15,y:py-Math.sin(pa)*i*15,
vx:0,vy:0,life:0.8,decay:0.04,
color:'#0ff',size:8
});
}
break;
case'burst':
for(let i=0;i<20;i++){
let angle=pa+(Math.random()-0.5)*1;
bullets.push({
x:px,y:py,
vx:Math.cos(angle)*22,
vy:Math.sin(angle)*22,
life:60
});
}
break;
case'coins':
for(let i=0;i<10;i++){
coins.push({
x:px+(Math.random()-0.5)*400,
y:py+(Math.random()-0.5)*400
});
}
break;
case'snipe':
let target=null,minDist=Infinity;
cops.forEach(cop=>{
let d=Math.hypot(cop.x-px,cop.y-py);
if(d<minDist){minDist=d;target=cop;}
});
if(target){
cops=cops.filter(c=>c!==target);
runCash+=300;
for(let i=0;i<50;i++){
particles.push({
x:target.x,y:target.y,
vx:(Math.random()-0.5)*15,
vy:(Math.random()-0.5)*15,
life:1,decay:0.025,
color:'#ff0',size:8
});
}
}
break;
case'rapid':
for(let j=0;j<8;j++){
setTimeout(()=>{
for(let i=0;i<3;i++){
bullets.push({
x:px,y:py,
vx:Math.cos(pa+(Math.random()-0.5)*0.3)*28,
vy:Math.sin(pa+(Math.random()-0.5)*0.3)*28,
life:70
});
}
},j*50);
}
break;
case'spread':
for(let i=-4;i<=4;i++){
bullets.push({
x:px,y:py,
vx:Math.cos(pa+i*0.2)*25,
vy:Math.sin(pa+i*0.2)*25,
life:60
});
}
break;
case'wave':
for(let i=0;i<360;i+=15){
let angle=i*Math.PI/180;
particles.push({
x:px,y:py,
vx:Math.cos(angle)*20,
vy:Math.sin(angle)*20,
life:1.5,decay:0.02,
color:'#0ff',size:12
});
}
cops=cops.filter(c=>Math.hypot(c.x-px,c.y-py)>250);
break;
case'destroy':
cops=[];
for(let i=0;i<150;i++){
particles.push({
x:px+(Math.random()-0.5)*600,
y:py+(Math.random()-0.5)*600,
vx:(Math.random()-0.5)*25,
vy:(Math.random()-0.5)*25,
life:1.5,decay:0.015,
color:['#f44','#fa0','#ff0'][Math.floor(Math.random()*3)],
size:10+Math.random()*15
});
}
runCash+=2000;
break;
default:
cops.forEach((cop,i)=>{
if(Math.hypot(cop.x-px,cop.y-py)<400){
for(let j=0;j<40;j++){
particles.push({
x:cop.x,y:cop.y,
vx:(Math.random()-0.5)*18,
vy:(Math.random()-0.5)*18,
life:1,decay:0.025,
color:['#f44','#fa0','#ff0'][Math.floor(Math.random()*3)],
size:7+Math.random()*9
});
}
cops.splice(i,1);
runCash+=250;
}
});
}
}

function startGame(){
screen='game';
document.getElementById('menuScreen').style.display='none';
document.getElementById('shopScreen').style.display='none';
document.getElementById('overScreen').style.display='none';
document.getElementById('hud').style.display='flex';
document.getElementById('stars').style.display='block';
document.getElementById('controls').style.display='block';
document.getElementById('abilityHint').textContent='A: '+cars[currentCar].abilityName;
runCash=0;time=0;wanted=1;cops=[];coins=[];particles=[];bullets=[];px=700;py=500;ps=0;pa=-Math.PI/2;jukeReady=true;jukeCooldown=0;shootReady=true;shootCooldown=0;abilityReady=true;abilityCooldown=0;shieldActive=false;shieldTime=0;
gameLoop();
}

function endGame(){
money+=runCash;
document.getElementById('finalTime').textContent=Math.floor(time/60)+':'+Math.floor(time%60).toString().padStart(2,'0');
document.getElementById('finalCash').textContent='$'+runCash;
screen='over';
document.getElementById('overScreen').style.display='flex';
document.getElementById('hud').style.display='none';
document.getElementById('stars').style.display='none';
document.getElementById('controls').style.display='none';
}

function showJukeMsg(){
let msg=document.getElementById('jukeMsg');
msg.classList.add('show');
setTimeout(()=>msg.classList.remove('show'),800);
}

function jukeCops(){
if(!jukeReady)return;
jukeReady=false;
jukeCooldown=180;
showJukeMsg();
cops.forEach(cop=>{
let dist=Math.hypot(cop.x-px,cop.y-py);
if(dist<400){
let angle=Math.atan2(cop.y-py,cop.x-px);
cop.x+=Math.cos(angle)*200;
cop.y+=Math.sin(angle)*200;
for(let i=0;i<20;i++){
particles.push({
x:cop.x,y:cop.y,
vx:(Math.random()-0.5)*15,
vy:(Math.random()-0.5)*15,
life:1,decay:0.03,
color:'#0ff',size:4+Math.random()*6
});
}
}
});
}

function shootGun(){
if(!cars[currentCar].gun||!shootReady)return;
shootReady=false;
shootCooldown=currentCar==='admincar'?5:8;
let numBullets=currentCar==='admincar'?5:3;
for(let i=0;i<numBullets;i++){
let spreadAngle=pa+(Math.random()-0.5)*0.4;
bullets.push({
x:px,y:py,
vx:Math.cos(spreadAngle)*25,
vy:Math.sin(spreadAngle)*25,
life:70
});
}
}

let keys={};
document.addEventListener('keydown',e=>{
keys[e.code]=true;
if(e.code==='KeyL'&&screen==='game')jukeCops();
if(e.code==='KeyA'&&screen==='game')useAbility();
if(e.code==='Space'&&screen==='game'){
e.preventDefault();
shootGun();
}
});
document.addEventListener('keyup',e=>keys[e.code]=false);

function drawCar(x,y,angle,color,isPolice){
ctx.save();
ctx.translate(x-cx,y-cy);
ctx.rotate(angle);
if(shieldActive&&!isPolice){
ctx.strokeStyle='#0ff';
ctx.lineWidth=6;
ctx.shadowColor='#0ff';
ctx.shadowBlur=30;
ctx.beginPath();
ctx.arc(0,0,60,0,Math.PI*2);
ctx.stroke();
}
ctx.shadowColor=color;
ctx.shadowBlur=30;
ctx.fillStyle=color;
ctx.fillRect(-24,-36,48,72);
let shineGrad=ctx.createLinearGradient(-24,-36,24,-36);
shineGrad.addColorStop(0,color);
shineGrad.addColorStop(0.3,'rgba(255,255,255,0.5)');
shineGrad.addColorStop(0.7,'rgba(255,255,255,0.3)');
shineGrad.addColorStop(1,color);
ctx.fillStyle=shineGrad;
ctx.fillRect(-24,-36,48,72);
let windGrad=ctx.createLinearGradient(-18,-32,18,-32);
windGrad.addColorStop(0,'#4488ff');
windGrad.addColorStop(0.5,'#88ccff');
windGrad.addColorStop(1,'#4488ff');
ctx.fillStyle=windGrad;
ctx.fillRect(-18,-32,36,24);
ctx.fillStyle='#333';
ctx.fillRect(-16,14,32,18);
ctx.fillStyle='#fff';
ctx.shadowColor='#fff';
ctx.shadowBlur=20;
ctx.fillRect(-20,-38,14,8);
ctx.fillRect(6,-38,14,8);
ctx.shadowBlur=15;
ctx.fillStyle='#f33';
ctx.shadowColor='#f33';
ctx.fillRect(-18,34,14,7);
ctx.fillRect(4,34,14,7);
ctx.shadowBlur=0;
ctx.fillStyle='#111';
ctx.strokeStyle='#444';
ctx.lineWidth=2;
ctx.fillRect(-28,-26,14,24);
ctx.strokeRect(-28,-26,14,24);
ctx.fillRect(14,-26,14,24);
ctx.strokeRect(14,-26,14,24);
ctx.fillRect(-28,12,14,24);
ctx.strokeRect(-28,12,14,24);
ctx.fillRect(14,12,14,24);
ctx.strokeRect(14,12,14,24);
if(isPolice){
ctx.fillStyle=frame%20<10?'#f00':'#00f';
ctx.shadowColor=frame%20<10?'#f00':'#00f';
ctx.shadowBlur=25;
ctx.fillRect(-14,-38,28,12);
ctx.shadowBlur=0;
}
ctx.restore();
}

function gameLoop(){
if(screen!=='game')return;
frame++;
time+=1/60;
wanted=Math.min(5,1+Math.floor(time/15));
if(jukeCooldown>0){
jukeCooldown--;
if(jukeCooldown===0)jukeReady=true;
}
if(shootCooldown>0){
shootCooldown--;
if(shootCooldown===0)shootReady=true;
}
if(abilityCooldown>0){
abilityCooldown--;
if(abilityCooldown===0)abilityReady=true;
}
if(shieldTime>0){
shieldTime--;
if(shieldTime===0)shieldActive=false;
}
if(keys['ArrowUp'])ps=Math.min(ps+0.5,pmax);
if(keys['ArrowDown'])ps=Math.max(ps-0.6,-6);
else ps*=0.96;
if(keys['ArrowLeft'])pa-=0.075;
if(keys['ArrowRight'])pa+=0.075;
px+=Math.cos(pa)*ps;
py+=Math.sin(pa)*ps;
cx=px-c.width/2;
cy=py-c.height/2;
let bgGrad=ctx.createRadialGradient(c.width/2,c.height/2,0,c.width/2,c.height/2,c.width/2);
bgGrad.addColorStop(0,'#0d0d22');
bgGrad.addColorStop(1,'#000');
ctx.fillStyle=bgGrad;
ctx.fillRect(0,0,c.width,c.height);
for(let y=0;y<map.length;y++){
for(let x=0;x<map[y].length;x++){
let wx=x*TS,wy=y*TS,sx=wx-cx,sy=wy-cy;
if(sx>-TS&&sx<c.width+TS&&sy>-TS&&sy<c.height+TS){
if(map[y][x]){
let roadGrad=ctx.createLinearGradient(sx,sy,sx+TS,sy+TS);
roadGrad.addColorStop(0,'#4a4a7d');
roadGrad.addColorStop(0.5,'#3a3a6d');
roadGrad.addColorStop(1,'#2a2a5d');
ctx.fillStyle=roadGrad;
ctx.fillRect(sx,sy,TS,TS);
ctx.strokeStyle='#ffaa44';
ctx.lineWidth=5;
ctx.lineCap='round';
ctx.shadowColor='#ffaa44';
ctx.shadowBlur=12;
ctx.beginPath();
ctx.moveTo(sx+TS/2,sy+15);
ctx.lineTo(sx+TS/2,sy+TS-15);
ctx.stroke();
ctx.shadowBlur=0;
}else{
ctx.fillStyle='#1a1a2f';
ctx.fillRect(sx,sy,TS,TS);
ctx.fillStyle='rgba(255,255,255,0.02)';
ctx.fillRect(sx+6,sy+6,TS-12,TS-12);
}
}
}
}
for(let i=coins.length-1;i>=0;i--){
let coin=coins[i];
ctx.save();
ctx.translate(coin.x-cx,coin.y-cy);
ctx.shadowColor='#ffaa00';
ctx.shadowBlur=30;
let coinGrad=ctx.createRadialGradient(0,0,0,0,0,20);
coinGrad.addColorStop(0,'#ffdd44');
coinGrad.addColorStop(0.5,'#ffaa00');
coinGrad.addColorStop(1,'#ff8800');
ctx.fillStyle=coinGrad;
ctx.beginPath();
ctx.arc(0,0,20,0,Math.PI*2);
ctx.fill();
ctx.shadowBlur=18;
ctx.strokeStyle='#ffff88';
ctx.lineWidth=4;
ctx.stroke();
ctx.restore();
if(Math.hypot(coin.x-px,coin.y-py)<42){
runCash+=50;
for(let j=0;j<20;j++){
particles.push({
x:coin.x,y:coin.y,
vx:(Math.random()-0.5)*14,
vy:(Math.random()-0.5)*14,
life:1,decay:0.02,
color:'#ffaa00',size:4+Math.random()*6
});
}
coins.splice(i,1);
}
}
for(let i=particles.length-1;i>=0;i--){
let p=particles[i];
p.x+=p.vx;
p.y+=p.vy;
p.vx*=0.96;
p.vy*=0.96;
p.life-=p.decay;
if(p.life<=0){
particles.splice(i,1);
continue;
}
ctx.save();
ctx.globalAlpha=p.life;
ctx.translate(p.x-cx,p.y-cy);
ctx.shadowColor=p.color;
ctx.shadowBlur=20;
let partGrad=ctx.createRadialGradient(0,0,0,0,0,p.size*p.life);
partGrad.addColorStop(0,p.color);
partGrad.addColorStop(1,'transparent');
ctx.fillStyle=partGrad;
ctx.beginPath();
ctx.arc(0,0,p.size*p.life,0,Math.PI*2);
ctx.fill();
ctx.restore();
}
for(let i=bullets.length-1;i>=0;i--){
let b=bullets[i];
b.x+=b.vx;
b.y+=b.vy;
b.life--;
if(b.life<=0){
bullets.splice(i,1);
continue;
}
ctx.save();
ctx.translate(b.x-cx,b.y-cy);
ctx.shadowColor='#ff0';
ctx.shadowBlur=25;
let bulletGrad=ctx.createRadialGradient(0,0,0,0,0,10);
bulletGrad.addColorStop(0,'#fff');
bulletGrad.addColorStop(0.5,'#ff0');
bulletGrad.addColorStop(1,'#f80');
ctx.fillStyle=bulletGrad;
ctx.beginPath();
ctx.arc(0,0,10,0,Math.PI*2);
ctx.fill();
ctx.restore();
}
if(frame%260==0&&cops.length<wanted){
for(let i=0;i<25;i++){
let tx=1+Math.floor(Math.random()*11)*TS+50;
let ty=1+Math.floor(Math.random()*10)*TS+50;
if(isRoad(tx,ty)&&Math.hypot(tx-px,ty-py)>350){
cops.push({x:tx,y:ty,health:1});
break;
}
}
}
for(let i=cops.length-1;i>=0;i--){
let cop=cops[i];
let dx=px-cop.x,dy=py-cop.y;
cop.pa=Math.atan2(dy,dx);
cop.x+=Math.cos(cop.pa)*(5.2+wanted*0.25);
cop.y+=Math.sin(cop.pa)*(5.2+wanted*0.25);
bullets.forEach((b,bi)=>{
if(Math.hypot(b.x-cop.x,b.y-cop.y)<40){
cop.health--;
bullets.splice(bi,1);
for(let j=0;j<30;j++){
particles.push({
x:cop.x,y:cop.y,
vx:(Math.random()-0.5)*18,
vy:(Math.random()-0.5)*18,
life:1,decay:0.022,
color:Math.random()>0.5?'#f80':'#ff0',size:6+Math.random()*8
});
}
if(cop.health<=0){
cops.splice(i,1);
runCash+=100;
}
}
});
if(cop.health>0){
drawCar(cop.x,cop.y,cop.pa,'#fff',true);
if(!shieldActive&&Math.hypot(cop.x-px,cop.y-py)<48){
endGame();
return;
}
}
}
drawCar(px,py,pa,cars[currentCar].c,false);
if(frame%110==0&&coins.length<10){
for(let i=0;i<20;i++){
let tx=1+Math.floor(Math.random()*11)*TS+50;
let ty=1+Math.floor(Math.random()*10)*TS+50;
if(isRoad(tx,ty)){
coins.push({x:tx,y:ty});
break;
}
}
}
document.getElementById('timeVal').textContent=Math.floor(time/60)+':'+Math.floor(time%60).toString().padStart(2,'0');
document.getElementById('speedVal').textContent=Math.round(Math.abs(ps)*11)+' MPH';
document.getElementById('cashVal').textContent='$'+runCash;
document.getElementById('wantedVal').textContent='‚òÖ'.repeat(wanted);
document.getElementById('stars').textContent='‚òÖ'.repeat(wanted);
requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
